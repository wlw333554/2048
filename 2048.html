<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title id="pageTitle">2048 - ч╗ПхЕ╕цХ░хнЧцЛ╝хЫ╛ц╕╕цИП</title>
  <!-- хдЦщГиш╡Дц║Рх╝ХхЕе -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mongolian&display=swap" rel="stylesheet">
  <!-- хЬЖц╢жхнЧф╜У -->
  <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@300;400;500&family=Noto+Sans+TC:wght@300;400;500&family=Yusei+Magic&display=swap" rel="stylesheet">
  <!-- ц╖╗хКач╜СчлЩхЫ╛цаЗ -->
  <link rel="icon" href="https://www.google.com/s2/favicons?sz=64&domain=2048game.com" type="image/png">
  <!-- Tailwind щЕНч╜о -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            monet: {
              light: '#e0c3fc',
              DEFAULT: '#8e2de2',
              dark: '#4a00e0',
              accent1: '#ffb6c1',
              accent2: '#add8e6',
              accent3: '#f0e68c',
              accent4: '#ffd700',
            },
          },
          fontFamily: {
            game: ['"Fredoka One"', 'cursive', 'sans-serif'],
            mongolian: ['"Noto Sans Mongolian"', 'Mongolian Baiti', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <!-- ца╕х┐Гца╖х╝П -->
  <style>
    /* хЯ║чбАщЗНч╜оф╕ОхЕих▒Аца╖х╝П */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background-color: #f8f5ff;
      background-image: radial-gradient(#d8c5ff 1px, transparent 0);
      background-size: 30px 30px;
      min-height: 100vh;
      font-family: 'Fredoka One', cursive;
      touch-action: manipulation; /* цФ╣ф╕║ manipulation щШ▓цнвц╗ЪхКиф╜ЖхЕБшо╕шзжцС╕ */
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .dark body {
      background-color: #1a1a2e;
      background-image: radial-gradient(#2a2a40 1px, transparent 0);
      color: #eaeaea;
    }
    /* шпншиАчЙ╣хоЪхнЧф╜Ушо╛ч╜о */
    body[data-lang="zh"] {
      font-family: 'Noto Sans SC', sans-serif;
      font-weight: 400;
    }
    body[data-lang="zh-TW"] {
      font-family: 'Noto Sans TC', sans-serif;
      font-weight: 400;
    }
    body[data-lang="ja"] {
      font-family: 'Yusei Magic', sans-serif;
    }
    /* шТЩхПдшпнчЙ╣цоКхнЧф╜УцФпцМБ */
    .mongolian-traditional {
      font-family: 'Noto Sans Mongolian', 'Mongolian Baiti', 'Microsoft PhagsPa', sans-serif;
      font-size: 1.1em;
      line-height: 1.4;
    }
    /* шо╛ч╜оцибцАБцбЖц╗ЪхКицЭбца╖х╝П */
    .settings-scroll {
      scrollbar-width: thin;
      scrollbar-color: #8e2de2 #e0c3fc;
    }
    .settings-scroll::-webkit-scrollbar {
      width: 8px;
    }
    .settings-scroll::-webkit-scrollbar-track {
      background: #e0c3fc;
      border-radius: 10px;
    }
    .settings-scroll::-webkit-scrollbar-thumb {
      background: #8e2de2;
      border-radius: 10px;
      border: 2px solid #e0c3fc;
    }
    .settings-scroll::-webkit-scrollbar-thumb:hover {
      background: #4a00e0;
    }
    .dark .settings-scroll {
      scrollbar-color: #8e2de2 #4a00e0;
    }
    .dark .settings-scroll::-webkit-scrollbar-track {
      background: #4a00e0;
    }
    .dark .settings-scroll::-webkit-scrollbar-thumb {
      background: #8e2de2;
      border: 2px solid #4a00e0;
    }
    .dark .settings-scroll::-webkit-scrollbar-thumb:hover {
      background: #e0c3fc;
    }
    /* ц╕╕цИПчК╢цАБцПРчд║ */
    .game-status {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 50;
      text-align: center;
      padding: 1rem;
      border-radius: 0.75rem;
      background-color: rgba(142, 45, 226, 0.8);
      color: white;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .game-status.active {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
      pointer-events: all; /* ц┐Ац┤╗цЧ╢хЕБшо╕чВ╣хЗ╗ */
    }
    /* ц╕╕цИПцгЛчЫШца╖х╝П */
    .game-board {
      background-color: rgba(230, 210, 255, 0.7);
      border-radius: 1rem;
      padding: 1rem;
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
      width: 100%;
      height: 100%;
      z-index: 10;
    }
    .dark .game-board {
      background-color: rgba(44, 44, 84, 0.7);
    }
    .game-board:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
    }
    .game-board::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 50%, rgba(0,0,0,0.05) 100%);
      z-index: 1;
    }
    .dark .game-board::before {
      background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 100%);
    }
    /* цгЛчЫШца╝хнРца╖х╝П */
    .cell {
      position: absolute;
      border-radius: 0.75rem;
      background-color: rgba(255, 255, 255, 0.3);
      z-index: 5;
      transition: background-color 0.3s ease;
    }
    .dark .cell {
      background-color: rgba(60, 60, 80, 0.3);
    }
    /* цХ░хнЧцЦ╣хЭЧца╕х┐Гца╖х╝П */
    .tile {
      position: absolute;
      z-index: 20;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border-radius: 0.75rem;
      transition: left 0.2s ease, top 0.2s ease, width 0.2s ease, height 0.2s ease;
      will-change: left, top, opacity;
    }
    /* цЦ╣хЭЧхКичФ╗цХИцЮЬ */
    .tile-merged {
      animation: tile-merged 0.3s ease-in-out;
      z-index: 30;
    }
    .new-tile {
      animation: new-tile 0.3s ease-out;
    }
    /* хКичФ╗хЕ│щФох╕з */
    @keyframes tile-merged {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
      100% { transform: scale(1); }
    }
    @keyframes new-tile {
      0% { opacity: 0; transform: scale(0.8); }
      100% { opacity: 1; transform: scale(1); }
    }
    /* цЦ╣хЭЧщвЬшЙ▓ч│╗ч╗Яя╝ИцМЙцХ░хА╝хМ║хИЖя╝Й */
    .tile-2 { background-color: rgba(230, 210, 255, 0.9); color: #5a3991; }
    .tile-4 { background-color: rgba(210, 180, 255, 0.9); color: #5a3991; }
    .tile-8 { background-color: rgba(255, 182, 193, 0.9); color: #ffffff; }
    .tile-16 { background-color: rgba(255, 160, 122, 0.9); color: #ffffff; }
    .tile-32 { background-color: rgba(255, 140, 0, 0.9); color: #ffffff; }
    .tile-64 { background-color: rgba(255, 105, 97, 0.9); color: #ffffff; }
    .tile-128 { background-color: rgba(255, 215, 0, 0.9); color: #ffffff; }
    .tile-256 { background-color: rgba(255, 215, 0, 0.95); color: #ffffff; box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }
    .tile-512 { background-color: rgba(255, 215, 0, 1); color: #ffffff; box-shadow: 0 0 20px rgba(255, 215, 0, 0.7); }
    .tile-1024 { background-color: rgba(255, 215, 0, 1); color: #ffffff; box-shadow: 0 0 25px rgba(255, 215, 0, 0.9); }
    .tile-2048 { background-color: rgba(255, 215, 0, 1); color: #ffffff; box-shadow: 0 0 30px rgba(255, 215, 0, 1); }
    .tile-super { background-color: rgba(128, 0, 128, 0.9); color: #ffffff; box-shadow: 0 0 35px rgba(128, 0, 128, 0.7); }
    /* ц╖▒шЙ▓цибх╝ПцЦ╣хЭЧщвЬшЙ▓щАВщЕН */
    .dark .tile-2 { background-color: rgba(170, 150, 255, 0.9); color: #e0e0ff; }
    .dark .tile-4 { background-color: rgba(150, 120, 255, 0.9); color: #e0e0ff; }
    .dark .tile-8 { background-color: rgba(255, 150, 160, 0.9); color: #ffffff; }
    .dark .tile-16 { background-color: rgba(255, 140, 100, 0.9); color: #ffffff; }
    .dark .tile-32 { background-color: rgba(255, 120, 0, 0.9); color: #ffffff; }
    .dark .tile-64 { background-color: rgba(255, 90, 80, 0.9); color: #ffffff; }
    .dark .tile-128 { background-color: rgba(255, 200, 0, 0.9); color: #ffffff; }
    .dark .tile-256 { background-color: rgba(255, 200, 0, 0.95); color: #ffffff; box-shadow: 0 0 15px rgba(255, 200, 0, 0.6); }
    .dark .tile-512 { background-color: rgba(255, 200, 0, 1); color: #ffffff; box-shadow: 0 0 20px rgba(255, 200, 0, 0.8); }
    .dark .tile-1024 { background-color: rgba(255, 200, 0, 1); color: #ffffff; box-shadow: 0 0 25px rgba(255, 200, 0, 1); }
    .dark .tile-2048 { background-color: rgba(255, 200, 0, 1); color: #ffffff; box-shadow: 0 0 30px rgba(255, 200, 0, 1.2); }
    .dark .tile-super { background-color: rgba(150, 30, 150, 0.9); color: #ffffff; box-shadow: 0 0 35px rgba(150, 30, 150, 0.8); }
    /* цМЙщТоф║дф║ТцХИцЮЬ */
    .btn-hover {
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-hover::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: all 0.6s ease;
    }
    .btn-hover:hover::after {
      left: 100%;
    }
    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(142, 45, 226, 0.3);
    }
    .btn-hover:active {
      transform: translateY(0);
    }
    /* хИЖцХ░хПШхМЦхКичФ╗ */
    .score-change {
      animation: score-change 0.5s ease-in-out;
    }
    @keyframes score-change {
      0% { transform: scale(1); color: #8e2de2; }
      50% { transform: scale(1.2); color: #ffd700; }
      100% { transform: scale(1); color: #8e2de2; }
    }
    /* цибцАБцбЖхЯ║чбАца╖х╝П */
    .modal {
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      transition: opacity 0.3s ease, visibility 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    .modal.active {
      opacity: 1;
      visibility: visible;
      pointer-events: all;
    }
    .modal-content {
      background-color: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      transition: transform 0.3s ease, background-color 0.3s ease;
      width: 100%;
      max-width: 320px;
      max-height: 90vh;
      position: relative;
      border-radius: 1rem;
      transform: scale(0.95);
      overflow: hidden;
    }
    .modal.active .modal-content {
      transform: scale(1);
    }
    .dark .modal-content {
      background-color: rgba(30, 30, 50, 0.95);
      color: #eaeaea;
    }
    /* х╝АхЕ│цМЙщТохЯ║чбАца╖х╝П */
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #8e2de2;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    /* шпншиАщАЙщб╣цМЙщТохКичФ╗цХИцЮЬ */
    .language-option {
      transition: all 0.2s ease;
    }
    .language-option:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 4px 12px rgba(142, 45, 226, 0.2);
    }
    .language-option.active {
      background-color: #8e2de2;
      color: white;
    }
    /* ц╕╕цИПщЪ╛х║жц╗СхКицЭбца╖х╝П */
    .difficulty-slider {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(to right, #e0c3fc, #8e2de2);
      outline: none;
      cursor: pointer;
    }
    .difficulty-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #8e2de2;
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
    }
    .difficulty-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 12px rgba(142, 45, 226, 0.6);
    }
    .difficulty-slider::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #8e2de2;
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
    }
    .difficulty-slider::-moz-range-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 12px rgba(142, 45, 226, 0.6);
    }
    .difficulty-slider::-webkit-slider-track {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(to right, #e0c3fc, #8e2de2);
    }
    .difficulty-slider::-moz-range-track {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(to right, #e0c3fc, #8e2de2);
      border: none;
    }
    .dark .difficulty-slider {
      background: linear-gradient(to right, #4a00e0, #8e2de2);
    }
    .dark .difficulty-slider::-webkit-slider-track {
      background: linear-gradient(to right, #4a00e0, #8e2de2);
    }
    .dark .difficulty-slider::-moz-range-track {
      background: linear-gradient(to right, #4a00e0, #8e2de2);
    }
    /* щУ╛цОеца╖х╝П */
    .contact-link {
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .contact-link:hover {
      color: #8e2de2;
      transform: translateY(-1px);
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 md:p-8" data-lang="zh">
  <!-- ц╕╕цИПхо╣хЩи -->
  <div class="w-full max-w-md mx-auto flex flex-col items-center gap-6">
    <!-- ц╕╕цИПцаЗщвШ -->
    <div class="w-full flex justify-between items-center">
      <h1 class="text-[clamp(2.5rem,8vw,4rem)] font-game font-bold text-monet-dark text-shadow">
        2048
      </h1>
      <div class="flex gap-2">
        <button id="howToPlayBtn" class="acrylic px-4 py-2 rounded-full text-monet-dark font-semibold flex items-center gap-2 hover:bg-white/30 transition-all btn-hover">
          <i class="fa fa-question-circle"></i>
          <span class="hidden sm:inline" data-i18n="howToPlay">чОйц│Х</span>
        </button>
        <button id="settingsBtn" class="acrylic px-4 py-2 rounded-full text-monet-dark font-semibold flex items-center gap-2 hover:bg-white/30 transition-all btn-hover">
          <i class="fa fa-cog"></i>
          <span class="hidden sm:inline" data-i18n="settings">шо╛ч╜о</span>
        </button>
        <button id="restartBtn" class="acrylic px-4 py-2 rounded-full text-monet-dark font-semibold flex items-center gap-2 hover:bg-white/30 transition-all btn-hover">
          <i class="fa fa-refresh"></i>
          <span class="hidden sm:inline" data-i18n="restart">щЗНцЭе</span>
        </button>
      </div>
    </div>
    <!-- хИЖцХ░щЭвцЭ┐ -->
    <div class="w-full flex justify-between gap-4 mb-2">
      <div class="acrylic flex-1 p-3 rounded-xl flex flex-col items-center">
        <div class="text-sm text-monet-dark font-medium" data-i18n="score">х╛ЧхИЖ</div>
        <div id="score" class="text-2xl font-bold text-monet-dark">0</div>
      </div>
      <div class="acrylic flex-1 p-3 rounded-xl flex flex-col items-center">
        <div class="text-sm text-monet-dark font-medium" data-i18n="bestScore">цЬАщлШхИЖ</div>
        <div id="bestScore" class="text-2xl font-bold text-monet-dark">0</div>
      </div>
    </div>
    <!-- ц╕╕цИПцгЛчЫШхо╣хЩи -->
    <div id="gameContainer" class="relative w-full aspect-square max-w-md mx-auto" tabindex="0" style="outline: none;">
      <div id="gameBoard" class="game-board">
        <!-- ц╕╕цИПчК╢цАБцПРчд║ -->
        <div id="gameStatus" class="game-status text-xl font-bold">
          <p id="gameStatusText" class="mb-2"></p>
          <button id="gameStatusBtn" class="bg-white text-monet px-4 py-2 rounded-full font-bold hover:bg-monet-dark hover:text-white transition-all btn-hover">
            ч╗зч╗нц╕╕цИП
          </button>
        </div>
        <!-- ца╝хнРхТМцЦ╣хЭЧх░ЖщАЪш┐ЗJSхКицАБчФЯцИР -->
      </div>
    </div>
    <!-- ц╕╕цИПцУНф╜ЬцПРчд║ -->
    <div class="w-full text-center mt-4 text-monet-dark/80">
      <p class="text-sm mb-2" data-i18n="keyboardHint">ф╜┐чФи <span class="font-bold">тЖС тЖУ тЖР тЖТ</span> цИЦ <span class='font-bold'>WASD</span> чз╗хКицЦ╣хЭЧ</p>
      <p class="text-sm" data-i18n="touchHint">цИЦхЬишзжцС╕х▒Пф╕К <span class='font-bold'>ц╗СхКи</span> чз╗хКи</p>
    </div>
    <!-- чЙИцЭГф┐бцБп -->
    <div class="w-full text-center mt-8 text-monet-dark/60">
      <p class="text-xs" id="copyrightInfo">┬й 2025 ф╣ЧшК╖. ф┐ЭчХЩцЙАцЬЙцЭГхИй.</p>
    </div>
  </div>
  <!-- ц╕╕цИПшп┤цШОцибцАБцбЖ -->
  <div id="howToPlayModal" class="modal">
    <div class="modal-content">
      <div class="p-6">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-2xl font-bold text-monet-dark" data-i18n="howToPlayTitle">хжВф╜ХчОй2048</h3>
          <button id="closeHowToPlayModalBtn" class="text-monet-dark text-xl hover:text-monet">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="space-y-4 text-monet-dark/90">
          <p data-i18n="howToPlayDesc1">ф╜┐чФицЦ╣хРСщФоцИЦWASDщФочз╗хКицЦ╣хЭЧя╝МчЫ╕хРМцХ░хнЧчЪДцЦ╣хЭЧф╝ЪхРИх╣╢цИРф╕║хоГф╗мчЪДхТМуАВ</p>
          <p data-i18n="howToPlayDesc2">цпПцмбчз╗хКихРОф╝ЪщЪПцЬ║чФЯцИРф╕Аф╕кцЦ░чЪД2цИЦ4цЦ╣хЭЧуАВ</p>
          <p data-i18n="howToPlayDesc3">х░ЭшпХхИЫщАацЫ┤щлШчЪДхИЖцХ░я╝Б</p>
        </div>
        <button id="startPlayingBtn" class="w-full mt-6 bg-monet text-white py-3 rounded-full font-bold hover:bg-monet-dark transition-all btn-hover" data-i18n="startPlaying">
          х╝АхзЛц╕╕цИП
        </button>
      </div>
    </div>
  </div>
  <!-- шо╛ч╜оцибцАБцбЖ -->
  <div id="settingsModal" class="modal">
    <div class="modal-content rounded-2xl p-6 max-w-md w-full mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-2xl font-bold text-monet-dark" data-i18n="settingsTitle">ц╕╕цИПшо╛ч╜о</h3>
        <button id="closeSettingsModalBtn" class="text-monet-dark text-xl hover:text-monet">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="settings-scroll overflow-y-auto pb-4 max-h-[60vh]">
        <div class="flex flex-col gap-6 min-w-full">
          <!-- шпншиАщАЙцЛйщАЙщб╣ -->
          <div class="p-4 bg-white/50 dark:bg-white/5 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <i class="fa fa-globe text-2xl text-monet-dark"></i>
              <span class="text-lg" data-i18n="language">шпншиА / Language</span>
            </div>
            <div class="language-selector flex flex-wrap gap-2">
              <div class="language-option active px-4 py-2 rounded-full text-center cursor-pointer transition-all" data-lang="zh">ф╕нцЦЗчоАф╜У</div>
              <div class="language-option px-4 py-2 rounded-full text-center cursor-pointer transition-all" data-lang="zh-TW">ф╕нцЦЗч╣БщлФ</div>
              <div class="language-option px-4 py-2 rounded-full text-center cursor-pointer transition-all" data-lang="en">English</div>
              <div class="language-option px-4 py-2 rounded-full text-center cursor-pointer transition-all" data-lang="ja">цЧецЬмшкЮ</div>
              <div class="language-option px-4 py-2 rounded-full text-center cursor-pointer transition-all mongolian-traditional" data-lang="mn-Mong" style="font-feature-settings: 'kern' 1, 'liga' 1;">саосагсайсансагсап</div>
            </div>
          </div>
          <!-- ф╕╗щвШхИЗцНвщАЙщб╣ -->
          <div class="p-4 bg-white/50 dark:bg-white/5 rounded-xl">
            <div class="flex items-center justify-between mb-2">
              <div class="flex items-center gap-3">
                <i class="fa fa-moon-o text-2xl text-monet-dark"></i>
                <span class="text-lg" data-i18n="darkMode">ц╖▒шЙ▓цибх╝П</span>
              </div>
              <label class="theme-switch">
                <input type="checkbox" id="themeToggle">
                <span class="slider"></span>
              </label>
            </div>
            <p class="text-sm text-monet-dark/80 mt-2" data-i18n="darkModeDesc">хИЗцНвц╕╕цИПчЪДшзЖшзЙф╕╗щвШуАВц╖▒шЙ▓цибх╝Пф╜┐чФиц╖▒шЙ▓шГМцЩпхТМщлШхп╣цпФх║жхЕГч┤ая╝МщАВхРИхдЬщЧ┤цИЦф╜ОхЕЙчОпхвГя╝МхПпхЗПш╜╗чЬ╝чЭЫчЦ▓хК│уАВ</p>
          </div>
          <!-- ц╕╕цИПщЪ╛х║жц╗СхКицЭб -->
          <div class="p-4 bg-white/50 dark:bg-white/5 rounded-xl">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-3">
                <i class="fa fa-tachometer text-2xl text-monet-dark"></i>
                <span class="text-lg" data-i18n="difficulty">ц╕╕цИПщЪ╛х║ж</span>
              </div>
              <span id="difficultyValue" class="px-3 py-1 bg-monet/20 rounded-full text-sm font-medium" data-i18n="difficultyMedium">ф╕нчнЙ</span>
            </div>
            <input type="range" min="1" max="3" value="2" class="difficulty-slider" id="difficultySlider">
            <div class="flex justify-between mt-2 text-xs text-monet-dark/70">
              <span data-i18n="difficultyEasy">чоАхНХ</span>
              <span data-i18n="difficultyMedium">ф╕нчнЙ</span>
              <span data-i18n="difficultyHard">хЫ░щЪ╛</span>
            </div>
            <p class="text-sm text-monet-dark/80 mt-3" data-i18n="difficultyDesc">ш░ГцХ┤ц╕╕цИПщЪ╛х║жф╝Ъх╜▒хУНхИЭхзЛцЦ╣хЭЧцХ░щЗПхТМчФЯцИРцЦ░цЦ╣хЭЧчЪДцжВчОЗуАВчоАхНХцибх╝ПцЫ┤хо╣цШУф╕КцЙЛя╝МхЫ░щЪ╛цибх╝ПцЫ┤хЕ╖цМСцИШцАзуАВ</p>
          </div>
          <!-- хЕ│щЧнхКичФ╗цХИцЮЬщАЙщб╣ -->
          <div class="p-4 bg-white/50 dark:bg-white/5 rounded-xl">
            <div class="flex items-center justify-between mb-2">
              <div class="flex items-center gap-3">
                <i class="fa fa-film text-2xl text-monet-dark"></i>
                <span class="text-lg" data-i18n="disableAnimations">хЕ│щЧнхКичФ╗цХИцЮЬ</span>
              </div>
              <label class="theme-switch">
                <input type="checkbox" id="disableAnimationsToggle">
                <span class="slider"></span>
              </label>
            </div>
            <p class="text-sm text-monet-dark/80 mt-2" data-i18n="disableAnimationsDesc">чжБчФиц╕╕цИПф╕нчЪДщГихИЖхКичФ╗цХИцЮЬя╝МхМЕцЛмцЦ╣хЭЧчз╗хКиуАБхРИх╣╢хТМцЦ░цЦ╣хЭЧхЗ║чО░чЪДхКичФ╗уАВф╝ЪчЙ║чЙ▓шзЖшзЙф╜УщкМуАВф╗ЕхЬишо╛хдЗцАзшГ╜ш╛Гх╖оцЧ╢шАГшЩСх╝АхРпуАВ</p>
          </div>
          <!-- хЕ│ф║ОщГихИЖ -->
          <div class="p-4 bg-white/50 dark:bg-white/5 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <i class="fa fa-info-circle text-2xl text-monet-dark"></i>
              <span class="text-lg" data-i18n="about">хЕ│ф║О</span>
            </div>
            <div class="flex items-center gap-4 p-3 bg-white/30 dark:bg-white/10 rounded-lg">
              <img src="https://i0.hdslb.com/bfs/face/e3ec881f2a8eb64fcf34b99f0c6756bd725b61b5.jpg@120w_120h_1c.avif" 
                   alt="ф╣ЧшК╖" 
                   class="w-16 h-16 rounded-full object-cover border-2 border-monet">
              <div class="flex-1">
                <h4 class="font-bold text-monet-dark text-lg">ф╣ЧшК╖</h4>
                <p class="text-sm text-monet-dark/80 mb-2" data-i18n="developer">ц╕╕цИПх╝АхПСшАЕ</p>
                <div class="space-y-2">
                  <a href="https://space.bilibili.com/3546768318925461" 
                     target="_blank" 
                     class="inline-flex items-center gap-2 text-monet hover:text-monet-dark transition-colors contact-link">
                    <img src="https://www.bilibili.com/favicon.ico" alt="BчлЩ" class="w-4 h-4">
                    <span data-i18n="visitBilibili">шо┐щЧоBчлЩф╕╗щб╡</span>
                  </a>
                  <a href="mailto:wulitian2@outlook.com" 
                     class="inline-flex items-center gap-2 text-monet-dark/80 hover:text-monet transition-colors contact-link">
                    <i class="fa fa-envelope text-monet"></i>
                    <span>wulitian2@outlook.com</span>
                  </a>
                </div>
              </div>
            </div>
            <p class="text-sm text-monet-dark/80 mt-3" data-i18n="aboutDesc">цДЯш░вцВичОйш┐Щф╕к2048ц╕╕цИПя╝Бш┐ЩцШпф╕Аф╕кф╜┐чФич║пHTMLуАБCSSхТМJavaScriptх╝АхПСчЪДхдЪшпншиАц╕╕цИПуАВ</p>
          </div>
        </div>
      </div>
      <button id="closeSettingsBtn" class="mt-6 w-full bg-monet text-white py-3 rounded-full font-bold hover:bg-monet-dark transition-all btn-hover" data-i18n="close">
        хЕ│щЧн
      </button>
    </div>
  </div>
  <script>
    // --- шпншиАч│╗ч╗Я ---
    const translations = {
      en: {
        howToPlay: "How to Play",
        settings: "Settings",
        restart: "Restart",
        score: "Score",
        bestScore: "Best Score",
        keyboardHint: "Use <span class='font-bold'>тЖС тЖУ тЖР тЖТ</span> or <span class='font-bold'>WASD</span> to move tiles",
        touchHint: "Or <span class='font-bold'>swipe</span> on touch screens",
        howToPlayTitle: "How to Play 2048",
        howToPlayDesc1: "Use arrow keys or WASD to move tiles. Tiles with the same number merge into one when they touch.",
        howToPlayDesc2: "A new tile (2 or 4) will randomly appear after each move.",
        howToPlayDesc3: "Try to create a higher score!",
        startPlaying: "Start Playing",
        settingsTitle: "Game Settings",
        language: "Language",
        darkMode: "Dark Mode",
        darkModeDesc: "Switch the visual theme of the game. Dark mode uses a dark background and high-contrast elements, suitable for night or low-light environments and can reduce eye strain.",
        difficulty: "Difficulty",
        difficultyEasy: "Easy",
        difficultyMedium: "Medium",
        difficultyHard: "Hard",
        difficultyDesc: "Adjusting the difficulty affects the number of initial tiles and the probability of generating new tiles. Easy mode is more accessible, while hard mode is more challenging.",
        disableAnimations: "Disable Animations",
        disableAnimationsDesc: "Disable some animation effects in the game, including tile movement, merging, and new tile appearance animations. This will sacrifice visual experience. Only consider enabling it if your device has poor performance.",
        close: "Close",
        gameWon: "You Win!",
        gameWonDesc: "You've reached 2048!",
        keepPlaying: "Keep Playing",
        newGame: "New Game",
        gameOver: "Game Over!",
        gameOverDesc: "No more moves available!",
        copyright: "┬й 2025 Cheng Zhi. All rights reserved.",
        about: "About",
        developer: "Game Developer",
        visitBilibili: "Visit Bilibili",
        aboutDesc: "Thank you for playing this 2048 game! This is a multilingual game developed with pure HTML, CSS and JavaScript."
      },
      zh: {
        howToPlay: "чОйц│Х",
        settings: "шо╛ч╜о",
        restart: "щЗНцЭе",
        score: "х╛ЧхИЖ",
        bestScore: "цЬАщлШхИЖ",
        keyboardHint: "ф╜┐чФи <span class='font-bold'>тЖС тЖУ тЖР тЖТ</span> цИЦ <span class='font-bold'>WASD</span> чз╗хКицЦ╣хЭЧ",
        touchHint: "цИЦхЬишзжцС╕х▒Пф╕К <span class='font-bold'>ц╗СхКи</span> чз╗хКи",
        howToPlayTitle: "хжВф╜ХчОй2048",
        howToPlayDesc1: "ф╜┐чФицЦ╣хРСщФоцИЦWASDщФочз╗хКицЦ╣хЭЧя╝МчЫ╕хРМцХ░хнЧчЪДцЦ╣хЭЧф╝ЪхРИх╣╢цИРф╕║хоГф╗мчЪДхТМуАВ",
        howToPlayDesc2: "цпПцмбчз╗хКихРОф╝ЪщЪПцЬ║чФЯцИРф╕Аф╕кцЦ░чЪД2цИЦ4цЦ╣хЭЧуАВ",
        howToPlayDesc3: "х░ЭшпХхИЫщАацЫ┤щлШчЪДхИЖцХ░я╝Б",
        startPlaying: "х╝АхзЛц╕╕цИП",
        settingsTitle: "ц╕╕цИПшо╛ч╜о",
        language: "шпншиА",
        darkMode: "ц╖▒шЙ▓цибх╝П",
        darkModeDesc: "хИЗцНвц╕╕цИПчЪДшзЖшзЙф╕╗щвШуАВц╖▒шЙ▓цибх╝Пф╜┐чФиц╖▒шЙ▓шГМцЩпхТМщлШхп╣цпФх║жхЕГч┤ая╝МщАВхРИхдЬщЧ┤цИЦф╜ОхЕЙчОпхвГя╝МхПпхЗПш╜╗чЬ╝чЭЫчЦ▓хК│уАВ",
        difficulty: "ц╕╕цИПщЪ╛х║ж",
        difficultyEasy: "чоАхНХ",
        difficultyMedium: "ф╕нчнЙ",
        difficultyHard: "хЫ░щЪ╛",
        difficultyDesc: "ш░ГцХ┤ц╕╕цИПщЪ╛х║жф╝Ъх╜▒хУНхИЭхзЛцЦ╣хЭЧцХ░щЗПхТМчФЯцИРцЦ░цЦ╣хЭЧчЪДцжВчОЗуАВчоАхНХцибх╝ПцЫ┤хо╣цШУф╕КцЙЛя╝МхЫ░щЪ╛цибх╝ПцЫ┤хЕ╖цМСцИШцАзуАВ",
        disableAnimations: "хЕ│щЧнхКичФ╗цХИцЮЬ(хоЮщкМцАз)",
        disableAnimationsDesc: "чжБчФиц╕╕цИПф╕нчЪДщГихИЖхКичФ╗цХИцЮЬя╝МхМЕцЛмцЦ╣хЭЧчз╗хКиуАБхРИх╣╢хТМцЦ░цЦ╣хЭЧхЗ║чО░чЪДхКичФ╗уАВф╝ЪчЙ║чЙ▓шзЖшзЙф╜УщкМуАВф╗ЕхЬишо╛хдЗцАзшГ╜ш╛Гх╖оцЧ╢шАГшЩСх╝АхРпуАВ",
        close: "хЕ│щЧн",
        gameWon: "ф╜аш╡вф║Ж!",
        gameWonDesc: "ф╜ах╖▓ч╗ПхРИцИРф║Ж2048!",
        keepPlaying: "ч╗зч╗нц╕╕цИП",
        newGame: "цЦ░ц╕╕цИП",
        gameOver: "ц╕╕цИПч╗УцЭЯ!",
        gameOverDesc: "цЧац│ХхЖНчз╗хКицЦ╣хЭЧф║Ж!",
        copyright: "┬й 2025 ф╣ЧшК╖. ф┐ЭчХЩцЙАцЬЙцЭГхИй.",
        about: "хЕ│ф║О",
        developer: "ц╕╕цИПх╝АхПСшАЕ",
        visitBilibili: "шо┐щЧоBчлЩф╕╗щб╡",
        aboutDesc: "цДЯш░вцВичОйш┐Щф╕к2048ц╕╕цИПя╝Бш┐ЩцШпф╕Аф╕кф╜┐чФич║пHTMLуАБCSSхТМJavaScriptх╝АхПСчЪДхдЪшпншиАц╕╕цИПуАВ"
      },
      "zh-TW": {
        howToPlay: "чОйц│Х",
        settings: "шинхоЪ",
        restart: "щЗНф╛Ж",
        score: "х╛ЧхИЖ",
        bestScore: "цЬАщлШхИЖ",
        keyboardHint: "ф╜┐чФи <span class='font-bold'>тЖС тЖУ тЖР тЖТ</span> цИЦ <span class='font-bold'>WASD</span> чз╗хЛХцЦ╣хбК",
        touchHint: "цИЦхЬишз╕цОзшЮвх╣Хф╕К <span class='font-bold'>ц╗СхЛХ</span> чз╗хЛХ",
        howToPlayTitle: "хжВф╜ХчОй2048",
        howToPlayDesc1: "ф╜┐чФицЦ╣хРСщН╡цИЦWASDщН╡чз╗хЛХцЦ╣хбКя╝МчЫ╕хРМцХ╕хнЧчЪДцЦ╣хбКцЬГхРИф╜╡цИРчВ║хоГхАСчЪДхТМуАВ",
        howToPlayDesc2: "цпПцмбчз╗хЛХх╛МцЬГщЪицйЯчФЯцИРф╕АхАЛцЦ░чЪД2цИЦ4цЦ╣хбКуАВ",
        howToPlayDesc3: "хШЧшйжхЙ╡щАацЫ┤щлШчЪДхИЖцХ╕я╝Б",
        startPlaying: "щЦЛхзЛщБКцИ▓",
        settingsTitle: "щБКцИ▓шинхоЪ",
        language: "шкЮшиА",
        darkMode: "ц╖▒шЙ▓цибх╝П",
        darkModeDesc: "хИЗцПЫщБКцИ▓чЪДшжЦшж║ф╕╗щбМуАВц╖▒шЙ▓цибх╝Пф╜┐чФиц╖▒шЙ▓шГМцЩпхТМщлШх░НцпФх║жхЕГч┤ая╝МщБйхРИхдЬщЦУцИЦф╜ОхЕЙчТ░хвГя╝МхПпц╕Ыш╝ХчЬ╝чЭЫчЦ▓хЛЮуАВ",
        difficulty: "щБКцИ▓щЫгх║ж",
        difficultyEasy: "ч░бхЦо",
        difficultyMedium: "ф╕нчнЙ",
        difficultyHard: "хЫ░щЫг",
        difficultyDesc: "шк┐цХ┤щБКцИ▓щЫгх║жцЬГх╜▒щЯ┐хИЭхзЛцЦ╣хбКцХ╕щЗПхТМчФЯцИРцЦ░цЦ╣хбКчЪДцйЯчОЗуАВч░бхЦоцибх╝ПцЫ┤хо╣цШУф╕КцЙЛя╝МхЫ░щЫгцибх╝ПцЫ┤хЕ╖цМСцИ░цАзуАВ",
        disableAnimations: "щЧЬщЦЙхЛХчХлцХИцЮЬ",
        disableAnimationsDesc: "чжБчФищБКцИ▓ф╕нчЪДщГихИЖхЛХчХлцХИцЮЬя╝МхМЕцЛмцЦ╣хбКчз╗хЛХуАБхРИф╜╡хТМцЦ░цЦ╣хбКхЗ║чП╛чЪДхЛХчХлуАВцЬГчКзчЙ▓шжЦшж║щлФщйЧуАВхГЕхЬишинхВЩцХИшГ╜ш╝Гх╖оцЩВшАГцЕощЦЛхХЯуАВ",
        close: "щЧЬщЦЙ",
        gameWon: "ф╜аш┤Пф║Ж!",
        gameWonDesc: "ф╜ах╖▓ч╢УхРИцИРф║Ж2048!",
        keepPlaying: "ч╣╝ч║МщБКцИ▓",
        newGame: "цЦ░щБКцИ▓",
        gameOver: "щБКцИ▓ч╡РцЭЯ!",
        gameOverDesc: "чДбц│ХхЖНчз╗хЛХцЦ╣хбКф║Ж!",
        copyright: "┬й 2025 ф╣ЧшК╖. чЙИцмКцЙАцЬЙ.",
        about: "щЧЬцЦ╝",
        developer: "щБКцИ▓щЦЛчЩ╝шАЕ",
        visitBilibili: "шикхХПBчлЩф╕╗щаБ",
        aboutDesc: "цДЯшмЭцВичОйщАЩхАЛ2048щБКцИ▓я╝БщАЩцШпф╕АхАЛф╜┐чФич┤ФHTMLуАБCSSхТМJavaScriptщЦЛчЩ╝чЪДхдЪшкЮшиАщБКцИ▓уАВ"
      },
      ja: {
        howToPlay: "щБКуБ│цЦ╣",
        settings: "шинхоЪ",
        restart: "хЖНуВ╣уВ┐уГ╝уГИ",
        score: "уВ╣уВ│уВв",
        bestScore: "уГЩуВ╣уГИуВ╣уВ│уВв",
        keyboardHint: "<span class='font-bold'>тЖС тЖУ тЖР тЖТ</span> уВнуГ╝уБ╛уБЯуБп <span class='font-bold'>WASD</span> уВнуГ╝уБзуВ┐уВдуГлуВТчз╗хЛХ",
        touchHint: "уБ╛уБЯуБпуВ┐уГГуГБуВ╣уВпуГкуГ╝уГ│уБз <span class='font-bold'>уВ╣уГпуВдуГЧ</span> уБЧуБжчз╗хЛХ",
        howToPlayTitle: "2048уБощБКуБ│цЦ╣",
        howToPlayDesc1: "чЯвхН░уВнуГ╝уБ╛уБЯуБпWASDуВнуГ╝уВТф╜┐чФиуБЧуБжуВ┐уВдуГлуВТчз╗хЛХуБХуБЫуБ╛уБЩуАВхРМуБШцХ░хнЧуБоуВ┐уВдуГлуБМцОешзжуБЩуВЛуБиуАБуБЭуВМуВЙуБпхРИф╜УуБЧуБжхРИшиИуБлуБкуВКуБ╛уБЩуАВ",
        howToPlayDesc2: "цпОхЫЮчз╗хЛХуБЧуБЯх╛МуАБуГйуГ│уГАуГауБлцЦ░уБЧуБД2уБ╛уБЯуБп4уБоуВ┐уВдуГлуБМчФЯцИРуБХуВМуБ╛уБЩуАВ",
        howToPlayDesc3: "уВИуВКщлШуБДуВ╣уВ│уВвуВТчЫоцМЗуБЧуБ╛уБЧуВЗуБЖя╝Б",
        startPlaying: "уВ▓уГ╝уГауВТхзЛуВБуВЛ",
        settingsTitle: "уВ▓уГ╝уГашинхоЪ",
        language: "шиАшкЮ",
        darkMode: "уГАуГ╝уВпуГвуГ╝уГЙ",
        darkModeDesc: "уВ▓уГ╝уГауБошжЦшжЪчЪДуБкуГЖуГ╝уГЮуВТхИЗуВКцЫ┐уБИуБ╛уБЩуАВуГАуГ╝уВпуГвуГ╝уГЙуБпцЪЧуБДшГМцЩпуБищлШуВ│уГ│уГИуГйуВ╣уГИуБошжБч┤ауВТф╜┐чФиуБЧуАБхдЬщЦУуВДф╜ОчЕзх║жчТ░хвГуБлщБйуБЧуБжуБКуВКуАБчЫоуБочЦ▓уВМуВТш╗╜ц╕ЫуБзуБНуБ╛уБЩуАВ",
        difficulty: "уВ▓уГ╝уГащЫгцШУх║ж",
        difficultyEasy: "ч░бхНШ",
        difficultyMedium: "цЩощАЪ",
        difficultyHard: "щЫгуБЧуБД",
        difficultyDesc: "щЫгцШУх║жуВТшк┐цХ┤уБЩуВЛуБиуАБхИЭцЬЯуВ┐уВдуГлуБоцХ░уБицЦ░уБЧуБДуВ┐уВдуГлуБМчФЯцИРуБХуВМуВЛчв║чОЗуБлх╜▒щЯ┐уБЧуБ╛уБЩуАВч░бхНШуГвуГ╝уГЙуБпхИЭх┐ГшАЕуБлуВДуБХуБЧуБПуАБщЫгуБЧуБДуГвуГ╝уГЙуБпуВИуВКцМСцИжчЪДуБзуБЩуАВ",
        disableAnimations: "уВвуГЛуГбуГ╝уВ╖уГзуГ│хК╣цЮЬуВТуВкуГХуБлуБЩуВЛ",
        disableAnimationsDesc: "уВ▓уГ╝уГахЖЕуБоф╕АщГиуБоуВвуГЛуГбуГ╝уВ╖уГзуГ│хК╣цЮЬя╝ИуВ┐уВдуГлуБочз╗хЛХуАБхРИф╜УуАБцЦ░уБЧуБДуВ┐уВдуГлуБохЗ║чП╛уБкуБйя╝ЙуВТчДбхК╣уБлуБЧуБ╛уБЩуАВшжЦшжЪчЪДуБкф╜УщиУуБМчКачЙ▓уБлуБкуВКуБ╛уБЩуАВуГЗуГРуВдуВ╣уБоуГСуГХуВйуГ╝уГЮуГ│уВ╣уБМф╜ОуБДха┤хРИуБлуБоуБ┐шАГцЕоуБЧуБжуБПуБауБХуБДуАВ",
        close: "щЦЙуБШуВЛ",
        gameWon: "уБВуБкуБЯуБохЛЭуБб!",
        gameWonDesc: "уБВуБкуБЯуБп2048уВТхРИцИРуБЧуБ╛уБЧуБЯ!",
        keepPlaying: "ч╢ЪуБСуБжщБКуБ╢",
        newGame: "цЦ░уБЧуБДуВ▓уГ╝уГа",
        gameOver: "уВ▓уГ╝уГауВкуГ╝уГРуГ╝!",
        gameOverDesc: "уБУуВМф╗еф╕Кчз╗хЛХуБзуБНуБ╛уБЫуВУ!",
        copyright: "┬й 2025 Cheng Zhi. All rights reserved.",
        about: "уБлуБдуБДуБж",
        developer: "уВ▓уГ╝уГащЦЛчЩ║шАЕ",
        visitBilibili: "BilibiliуВТшикхХП",
        aboutDesc: "уБУуБо2048уВ▓уГ╝уГауВТуГЧуГмуВдуБЧуБжуБДуБЯуБауБНуБВуВКуБМуБиуБЖуБФуБЦуБДуБ╛уБЩя╝БуБУуВМуБпч┤Фч▓ЛуБкHTMLуАБCSSуАБJavaScriptуБзщЦЛчЩ║уБХуВМуБЯхдЪшиАшкЮуВ▓уГ╝уГауБзуБЩуАВ"
      },
      "mn-Mong": {
        howToPlay: "са▓саЛсадсансаЛсапсаасамсад сааса╖сансаа",
        settings: "са▓саЛсагсамсавса╖сансаа",
        restart: "са│саасамсавсаи сабсамсабсапсабсамсаж",
        score: "сагсаисагсансаа",
        bestScore: "са│сабсансабса│саж сагсаисагсансаа",
        keyboardHint: "<span class='font-bold'>тЖС тЖУ тЖР тЖТ</span> сабса░сабсансабсапсаб саксажсаЛ <span class='font-bold'>WASD</span> са▓сагсакса┤савсансадса│ савса╢сабсаи самсаеса│сабсапсансабсаисаб",
        touchHint: "сабса░сабсансабсапсаб саосабса│сабса╖сабсансабса┤саб са│сабсапсабсансабса┤саб са│саб <span class='font-bold'>са▒сажсажса╖сабсаи</span> самсаеса│сабсапсансабсаисаб",
        howToPlayTitle: "2048 самсабса╖сабсансамсаб са▓садсансапсаасамсад",
        howToPlayDesc1: "са░садсаосадсаи саж са▓сагсакса┤савсан сабса░сабсансабсапсаб саксажсаЛ саксажсаЛ WASD са▓сагсакса┤савсансадса│ савса╢сабсаи самсаеса│сабсапсансабсаисаб. савса╡савсап са▓сагсансааса▓саасав самсабса░сабсансабсаисажса│ самсабса░сабсансабсаисажса│ самсажса╖сабсапса┤сабсамсаж сажсансабсав саисабсавсансабса│сажсанса░сабсаисаб.",
        howToPlayDesc2: "самсаеса│сабсапсансаб саксажса╖савса╢сабсаи саж са│сааса╖саасансаа 2 сабса░сабсансабсапсаб саксажсаЛ 4 са▓сагсансааса▓саасав са░савсаисаб самсабса░сабсансабсаисажса│ са░саасаисаасаоса░сааса╖сансадсансадсапсамсад сансааса╖са┤саасамсад.",
        howToPlayDesc3: "савсапсажсансаб саесаиса│саеса╖ сагсаисагсансаа саасаксамсадса╖сааса╡сад са║савса┤сабсансабсаисаб!",
        startPlaying: "са▓садсансапсаасамсад",
        settingsTitle: "са▓садсансапсагсао саж са▓сагсамсавса╖сансаа",
        language: "са║сабсапсаб",
        darkMode: "самсааса╖саасайсамсадсав сансагса╖савсао",
        darkModeDesc: "са▓садсансапсагсао саж са║сааса╖саасанса│сааса┤сав саесайсансаб саж са╡саасансадсапсав саксаасавса┤саасансаасаисаа. самсааса╖саасайсамсадсав сансагса╖савсао саисажсаЛ самсааса╖саасайсамсадсав са│сабсаксабса░сабса╖ саесайсансаб саесаиса│саеса╖ са║сагсаиса▓саЛса╖сааса░са▓са▓саасав сабсапсабсаосабсаиса▓сажса│ сааса┤савсамсад саксажсаЛсабсаисаб са▒саесаисав саж са┤саасан сабса░сабсансабсапсаб са║сабса╖сабсансабсаисав са┤саасансаасаи сагса╖са┤савсаи са▓сагсансадса╖самсаасаоса▓сад са▓сагсансадсаоса▓саасапса┤саасамсад саксажсаЛсабсаисаб саисажса│сабсаи саж са╢сааса│саасапсансаасапса▓саа саксаасансадса╡сад са▓саасансаасансааса┤савсапсаасаисаб.",
        difficulty: "са║сабса┤сажсансаб саксаасавса│саасап",
        difficultyEasy: "саасаосааса╖самсаасаи",
        difficultyMedium: "са│садсайса│ са╡сабса╖сабсан",
        difficultyHard: "са║сабса┤сажсансаб",
        difficultyDesc: "са║сабса┤сажсансаб саксаасавса│саасап савса╢сабсаи са▓сагсамсавса╖сансаасамсад саисажсаЛ саасайсамсаасаи саж самсабса░сабсансабсаисажса│ сажсаи са▓сагсансаа саксажсаЛсабсаисаб са░савсаисаб самсабса░сабсансабсаисажса│ сажсаи саосаасансааса│саасап са│сабса│ саисагсапсадсансааса│самсад. саасаосааса╖самсаасаи сансагса╖савсао саисажсаЛ сабсамсабсапсабсансабса│са▓сажса╖ са▓сагсансадса╖самсаасаоса▓сад са▓сагсансадсаоса▓саасапса┤саасамсад саксажсаЛсабсаисаб са║сабса┤сажсансаб сансагса╖савсао саисажсаЛ савсапсажсансаб са░сагса╖савсапсансаасапса▓сааса▓саасав саксаасавсаисаа.",
        disableAnimations: "са║саеса│сабсапсансабсаи саж савса│сабсаксамсамсавса╖сансаасамсад",
        disableAnimationsDesc: "са▓садсансапсагсао са│сааса╖саасансаа са║саеса│сабсапсансабсаи саж сабса╕сазса║са▓савса╢сабсаи савса│сабсаксамсамсавса╖сансаасаисаб. сажсаиса│сабса░ са│саб самсабса░сабсансабсаисажса│ сажсаи са║саеса│сабсапсансабсаи саисабсавсансабса│сажсанса░сабсаисаб саксажсаЛсабсаисаб са░савсаисаб самсабса░сабсансабсаисажса│ сансааса╖са┤саасамсад са║саеса│сабсапсансабсаи сажсаиса│сабса░ саксаасансадса╡сад са▓саасансаасансааса┤савсапсаасаисаб. саисажсаЛ са║сааса╖саасанса│сааса┤сав саксаасавса│саасап савса╢сабсаи саксаасансадса╡сад са▓саасансаасансааса┤савсапсаасаисаб. са│саасаисавсаоса│сааса╖ са▓саесамсаеса║сагса╖сагсаоса╡сав сажсаи сансажсаиса┤савсансабсаи саосадсад саксаасавсаисаа саксагсап савса│сабсаксамсамсавса╖сансааса╡сад са░саасаисааса╡сад саксаасавсанса░саасаисаб.",
        close: "са║саасамсад",
        gameWon: "са▓саа са║сагса╡савсапсаа!",
        gameWonDesc: "са▓саа 2048-савсав са║сажса╖са▓сабсапсаб!",
        keepPlaying: "сажса╖сансабсапсабсапсабсамсаж",
        newGame: "са░савсаисаб са▓садсансапсагсао",
        gameOver: "са▓садсансапсагсао са│садса▓саасансаасапсаасамсад!",
        gameOverDesc: "саисабсаосабсамсаж са║саеса│сабсапсансабсаи садсапсадса░ саксаасавсансадсапсамсадсансаа!",
        copyright: "┬й 2025 са┤сазсай са╜сав. саксажса║сажса╖ сабса╖самсаж са║сабса┤сабсаксабса╖сабсамсаж.",
        about: "са▓садсансаасав",
        developer: "са▓садсансапсагсао саксабса┤савсаи саксажса┤сажсансабса╖сабсамсаж",
        visitBilibili: "Bilibili самсаасансадсапсаасансаасаи сажсаЛса░сабсансабса╖самсабсап",
        aboutDesc: "сабсаисаб 2048 са▓садсансапсагсао са▓садсансапсааса╡сад саксааса╢савсаисаасаГ сабсаисаб саисажсаЛ са║сабсапсабсаисажса│сабса┤саб саксабса┤савсансабса╖сабсамсаж са▓садсансапсагсао саксажсаЛсабсаисаб HTML, CSS, JavaScript сааса╖садсансадса│ саксабса┤савсансабса╖сабсанса░сабсаисаб."
      }
    };
    // --- х╖ехЕ╖хЗ╜цХ░ ---
    const utils = {
      /**
       * шО╖хПЦDOMхЕГч┤а
       * @param {string} selector - CSSщАЙцЛйхЩи
       * @returns {HTMLElement} DOMхЕГч┤а
       */
      getElement(selector) {
        return document.querySelector(selector);
      },
      /**
       * шО╖хПЦхдЪф╕кDOMхЕГч┤а
       * @param {string} selector - CSSщАЙцЛйхЩи
       * @returns {NodeList} DOMхЕГч┤ахИЧшби
       */
      getElements(selector) {
        return document.querySelectorAll(selector);
      },
      /**
       * цЙУх╝АцибцАБцбЖ
       * @param {string} modalId - цибцАБцбЖID
       */
      openModal(modalId) {
        const modal = this.getElement(`#${modalId}`);
        if (modal) {
          modal.classList.add('active');
        }
      },
      /**
       * хЕ│щЧнцибцАБцбЖ
       * @param {string} modalId - цибцАБцбЖID
       */
      closeModal(modalId) {
        const modal = this.getElement(`#${modalId}`);
        if (modal) {
          modal.classList.remove('active');
          setTimeout(() => this.getElement('#gameContainer').focus(), 300);
        }
      },
      /**
       * цШ╛чд║ц╕╕цИПчК╢цАБцПРчд║
       * @param {string} status - чК╢цАБч▒╗хЮЛ ('won', 'gameOver')
       */
      showGameStatus(status) {
        const statusElement = this.getElement('#gameStatus');
        const statusTextElement = this.getElement('#gameStatusText');
        const statusBtnElement = this.getElement('#gameStatusBtn');
        if (status === 'won') {
          statusTextElement.textContent = translations[currentLanguage].gameWonDesc || "You've reached 2048!";
          statusBtnElement.textContent = translations[currentLanguage].keepPlaying || "Keep Playing";
          // щЗНцЦ░ч╗СхоЪчВ╣хЗ╗ф║Лф╗╢
          statusBtnElement.onclick = () => {
            statusElement.classList.remove('active');
            if (window.game) {
              window.game.resumeAfterWin();
            }
          };
        } else if (status === 'gameOver') {
          statusTextElement.textContent = translations[currentLanguage].gameOverDesc || "No more moves available!";
          statusBtnElement.textContent = translations[currentLanguage].newGame || "New Game";
          // щЗНцЦ░ч╗СхоЪчВ╣хЗ╗ф║Лф╗╢
          statusBtnElement.onclick = () => {
            statusElement.classList.remove('active');
            if (window.game) {
              window.game.init();
            }
          };
        }
        statusElement.classList.add('active');
      },
      /**
       * цЫ┤цЦ░ц╕╕цИПчК╢цАБцПРчд║чЪДцЦЗцЬм
       */
      updateGameStatusText() {
        const statusElement = this.getElement('#gameStatus');
        if (statusElement.classList.contains('active')) {
          const statusTextElement = this.getElement('#gameStatusText');
          const statusBtnElement = this.getElement('#gameStatusBtn');
          // ца╣цНох╜УхЙНцШ╛чд║чЪДхЖЕхо╣хИдцЦнцШпшГЬхИйш┐ШцШпц╕╕цИПч╗УцЭЯ
          const currentText = statusTextElement.textContent;
          const currentBtnText = statusBtnElement.textContent;
          // цгАцЯецШпхРжцШпшГЬхИйчК╢цАБ
          const wonDescKeys = Object.values(translations).map(t => t.gameWonDesc);
          const keepPlayingKeys = Object.values(translations).map(t => t.keepPlaying);
          // цгАцЯецШпхРжцШпц╕╕цИПч╗УцЭЯчК╢цАБ
          const gameOverDescKeys = Object.values(translations).map(t => t.gameOverDesc);
          const newGameKeys = Object.values(translations).map(t => t.newGame);
          if (wonDescKeys.includes(currentText) || keepPlayingKeys.includes(currentBtnText)) {
            // шГЬхИйчК╢цАБ
            statusTextElement.textContent = translations[currentLanguage].gameWonDesc;
            statusBtnElement.textContent = translations[currentLanguage].keepPlaying;
            // щЗНцЦ░ч╗СхоЪф║Лф╗╢
            statusBtnElement.onclick = () => {
              statusElement.classList.remove('active');
              if (window.game) {
                window.game.resumeAfterWin();
              }
            };
          } else if (gameOverDescKeys.includes(currentText) || newGameKeys.includes(currentBtnText)) {
            // ц╕╕цИПч╗УцЭЯчК╢цАБ
            statusTextElement.textContent = translations[currentLanguage].gameOverDesc;
            statusBtnElement.textContent = translations[currentLanguage].newGame;
            // щЗНцЦ░ч╗СхоЪф║Лф╗╢
            statusBtnElement.onclick = () => {
              statusElement.classList.remove('active');
              if (window.game) {
                window.game.init();
              }
            };
          }
        }
      },
      /**
       * цЫ┤цЦ░UIцЦЗцЬм
       */
      updateUI() {
        // цЫ┤цЦ░bodyчЪДшпншиАх▒ЮцАз
        document.body.setAttribute('data-lang', currentLanguage);
        document.querySelectorAll('[data-i18n]').forEach(element => {
          const key = element.getAttribute('data-i18n');
          if (translations[currentLanguage] && translations[currentLanguage][key]) {
            // чЙ╣цоКхдДчРЖхМЕхРлHTMLчЪДхЖЕхо╣
            if (key === 'keyboardHint' || key === 'touchHint') {
              element.innerHTML = translations[currentLanguage][key];
            } else {
              element.textContent = translations[currentLanguage][key];
            }
          }
        });
        // цЫ┤цЦ░чЙИцЭГф┐бцБп
        const copyrightElement = document.getElementById('copyrightInfo');
        if (copyrightElement && translations[currentLanguage] && translations[currentLanguage].copyright) {
          copyrightElement.textContent = translations[currentLanguage].copyright;
        }
        let titleText;
        if (currentLanguage === 'zh') {
          titleText = '2048 - ч╗ПхЕ╕цХ░хнЧцЛ╝хЫ╛ц╕╕цИП';
        } else if (currentLanguage === 'zh-TW') {
          titleText = '2048 - ч╢УхЕ╕цХ╕хнЧцЛ╝хЬЦщБКцИ▓';
        } else if (currentLanguage === 'ja') {
          titleText = '2048 - хПдхЕ╕чЪДуБкцХ░хнЧуГСуВ║уГлуВ▓уГ╝уГа';
        } else if (currentLanguage === 'mn-Mong') {
          titleText = '2048 - са░сагсайсансагса│сагсан са▓сагсансаасаи саж сагсаисавса░сагсансаг са▓садсансапсагсао';
        } else {
          titleText = '2048 - Classic Number Puzzle Game';
        }
        document.getElementById('pageTitle').textContent = titleText;
        // цЫ┤цЦ░ц╕╕цИПчК╢цАБцПРчд║цЦЗцЬм
        this.updateGameStatusText();
        // ф┐охдНшпншиАхИЗцНвцЧ╢цЙАцЬЙх╝АхЕ│чЪДхЬЖхЬИф╜Нч╜ощЧощвШ
        const toggleInputs = document.querySelectorAll('.theme-switch input');
        toggleInputs.forEach(input => {
          input.style.display = 'none';
        });

        // ЁЯФз ф┐охдНя╝ЪшпншиАхИЗцНвхРОхРМцнецЫ┤цЦ░щЪ╛х║жц╗СхЭЧцЦЗцЬм
        if (window.game && game.dom.difficultyValue) {
          const difficulty = gameSettings.difficulty;
          let key = '';
          if (difficulty === 1) key = 'difficultyEasy';
          else if (difficulty === 2) key = 'difficultyMedium';
          else key = 'difficultyHard';
          game.dom.difficultyValue.textContent = translations[currentLanguage][key] || key;
        }
      }
    };
    // --- ц╕╕цИПщЕНч╜охТМшо╛ч╜о ---
    const config = {
      gridSize: 4,
      winningValue: 2048
    };
    const gameSettings = {
      disableAnimations: localStorage.getItem('2048-disable-animations') === 'true',
      difficulty: parseInt(localStorage.getItem('2048-difficulty')) || 2 // 1-чоАхНХ, 2-ф╕нчнЙ, 3-хЫ░щЪ╛
    };
    let currentLanguage = localStorage.getItem('2048-language') || 'zh';
    // --- ц╕╕цИПф╕╗ч▒╗ ---
    class Game2048 {
      constructor() {
        // DOMхЕГч┤ач╝УхнШ
        this.dom = {
          gameBoard: utils.getElement('#gameBoard'),
          scoreDisplay: utils.getElement('#score'),
          bestScoreDisplay: utils.getElement('#bestScore'),
          restartBtn: utils.getElement('#restartBtn'),
          howToPlayBtn: utils.getElement('#howToPlayBtn'),
          howToPlayModal: utils.getElement('#howToPlayModal'),
          closeHowToPlayModalBtn: utils.getElement('#closeHowToPlayModalBtn'),
          startPlayingBtn: utils.getElement('#startPlayingBtn'),
          gameContainer: utils.getElement('#gameContainer'),
          settingsBtn: utils.getElement('#settingsBtn'),
          settingsModal: utils.getElement('#settingsModal'),
          closeSettingsModalBtn: utils.getElement('#closeSettingsModalBtn'),
          closeSettingsBtn: utils.getElement('#closeSettingsBtn'),
          themeToggle: null,
          disableAnimationsToggle: null,
          difficultySlider: null,
          difficultyValue: null,
          languageOptions: utils.getElements('.language-option')
        };
        // ц╕╕цИПчК╢цАБ
        this.grid = [];
        // ЁЯФз ф┐охдНя╝ЪщШ▓цнв localStorage ш┐ФхЫЮ NaN
        const savedBest = localStorage.getItem('2048-best-score');
        this.bestScore = savedBest ? Math.max(0, parseInt(savedBest) || 0) : 0;
        this.score = 0;
        this.gameWon = false;
        this.isProcessingMove = false;
        this.isAnimating = false;
        // х░║хп╕шобчоЧ
        this.tileSize = 0;
        this.tileGap = 0;
        this.boardPadding = 0;
        // хИЭхзЛхМЦц╕╕цИП
        this.init();
      }
      /**
       * хИЭхзЛхМЦц╕╕цИП
       */
      init() {
        // щЗНч╜оц╕╕цИПчК╢цАБ
        this.grid = Array(config.gridSize).fill().map(() => Array(config.gridSize).fill(null));
        this.score = 0;
        this.gameWon = false;
        this.isProcessingMove = false;
        // цЫ┤цЦ░UI
        this.updateScoreDisplay(false);
        // шобчоЧх░║хп╕х╣╢ц╕▓цЯУ
        this.calculateTileSize();
        this.renderGrid();
        // ца╣цНощЪ╛х║жшо╛ч╜охИЭхзЛцЦ╣хЭЧцХ░щЗП
        const startTiles = gameSettings.difficulty === 3 ? 3 : 2;
        for (let i = 0; i < startTiles; i++) {
          this.addRandomTile();
        }
        // шо╛ч╜очДжчВ╣
        this.dom.gameContainer.focus();
      }
      /**
       * шобчоЧцгЛчЫШхТМцЦ╣хЭЧх░║хп╕
       */
      calculateTileSize() {
        const boardRect = this.dom.gameBoard.getBoundingClientRect();
        this.boardPadding = parseInt(getComputedStyle(this.dom.gameBoard).paddingLeft);
        const boardSize = Math.min(boardRect.width, boardRect.height) - (this.boardPadding * 2);
        this.tileGap = Math.floor(boardSize * 0.05);
        this.tileSize = Math.floor((boardSize - (config.gridSize - 1) * this.tileGap) / config.gridSize);
        // ш░ГцХ┤цгЛчЫШх░║хп╕ф╗ечбоф┐Эч▓╛чбохМ╣щЕН
        const adjustedSize = (this.tileSize * config.gridSize) + (this.tileGap * (config.gridSize - 1)) + (this.boardPadding * 2);
        this.dom.gameBoard.style.width = `${adjustedSize}px`;
        this.dom.gameBoard.style.height = `${adjustedSize}px`;
        document.documentElement.style.setProperty('--board-width', `${adjustedSize}px`);
      }
      /**
       * ц╕▓цЯУцгЛчЫШца╝хнР
       */
      renderGrid() {
        this.dom.gameBoard.innerHTML = ''; // ц╕Ечй║цгЛчЫШ
        // ц╖╗хКац╕╕цИПчК╢цАБхЕГч┤а
        const statusElement = document.createElement('div');
        statusElement.id = 'gameStatus';
        statusElement.className = 'game-status text-xl font-bold';
        statusElement.innerHTML = `
          <p id="gameStatusText" class="mb-2"></p>
          <button id="gameStatusBtn" class="bg-white text-monet px-4 py-2 rounded-full font-bold hover:bg-monet-dark hover:text-white transition-all btn-hover">
            ч╗зч╗нц╕╕цИП
          </button>
        `;
        this.dom.gameBoard.appendChild(statusElement);
        // хИЫх╗║ца╝хнР
        for (let y = 0; y < config.gridSize; y++) {
          for (let x = 0; x < config.gridSize; x++) {
            const cell = document.createElement('div');
            cell.classList.add('cell');
            cell.style.width = `${this.tileSize}px`;
            cell.style.height = `${this.tileSize}px`;
            cell.style.left = `${this.boardPadding + x * (this.tileSize + this.tileGap)}px`;
            cell.style.top = `${this.boardPadding + y * (this.tileSize + this.tileGap)}px`;
            this.dom.gameBoard.appendChild(cell);
          }
        }
      }
      /**
       * хЬищЪПцЬ║чй║ф╜Нч╜оц╖╗хКаф╕Аф╕кцЦ░цЦ╣хЭЧ
       * @returns {boolean} цШпхРжцИРхКЯц╖╗хКа
       */
      addRandomTile() {
        const availableCells = [];
        for (let y = 0; y < config.gridSize; y++) {
          for (let x = 0; x < config.gridSize; x++) {
            if (!this.grid[y][x]) {
              availableCells.push({ x, y });
            }
          }
        }
        if (availableCells.length === 0) return false;
        const cell = availableCells[Math.floor(Math.random() * availableCells.length)];
        // ца╣цНощЪ╛х║жш░ГцХ┤чФЯцИР4чЪДцжВчОЗ
        const fourProbability = gameSettings.difficulty === 3 ? 0.3 : (gameSettings.difficulty === 2 ? 0.1 : 0.05);
        const value = Math.random() < (1 - fourProbability) ? 2 : 4;
        this.grid[cell.y][cell.x] = value;
        this.renderTile(cell.x, cell.y, value, true);
        // ЁЯФз ф┐охдНя╝ЪшГЬхИйцЭбф╗╢цФ╣ф╕║ >=
        if (value >= config.winningValue && !this.gameWon) {
          this.gameWon = true;
          setTimeout(() => utils.showGameStatus('won'), 500);
        }
        return true;
      }
      /**
       * ц╕▓цЯУхНХф╕кцЦ╣хЭЧ
       * @param {number} x - xхЭРцаЗ
       * @param {number} y - yхЭРцаЗ
       * @param {number} value - цЦ╣хЭЧцХ░хА╝
       * @param {boolean} [isNew=false] - цШпхРжцШпцЦ░цЦ╣хЭЧ
       * @param {boolean} [isMerged=false] - цШпхРжцШпхРИх╣╢хРОчЪДцЦ╣хЭЧ
       */
      renderTile(x, y, value, isNew = false, isMerged = false) {
        // чз╗щЩдцЧзчЪДцЦ╣хЭЧ
        const existingTiles = this.dom.gameBoard.querySelectorAll(`.tile[data-x="${x}"][data-y="${y}"]`);
        existingTiles.forEach(tile => tile.remove());
        if (value) {
          const tile = document.createElement('div');
          const tileClass = value > 2048 ? 'tile-super' : `tile-${value}`;
          tile.classList.add(
            'tile',
            tileClass,
            'text-xl',
            'sm:text-2xl',
            'font-bold',
            'tile-shadow'
          );
          tile.style.width = `${this.tileSize}px`;
          tile.style.height = `${this.tileSize}px`;
          tile.style.left = `${this.boardPadding + x * (this.tileSize + this.tileGap)}px`;
          tile.style.top = `${this.boardPadding + y * (this.tileSize + this.tileGap)}px`;
          tile.textContent = value;
          tile.dataset.x = x;
          tile.dataset.y = y;
          // ц╖╗хКахКичФ╗ч▒╗
          if (isNew && !gameSettings.disableAnimations) {
            tile.classList.add('new-tile');
          }
          if (isMerged && !gameSettings.disableAnimations) {
            tile.classList.add('tile-merged');
          }
          this.dom.gameBoard.appendChild(tile);
          this.adjustTileFontSize(tile, value);
        }
      }
      /**
       * ца╣цНоцХ░хА╝ш░ГцХ┤цЦ╣хЭЧхнЧф╜Ухдзх░П
       * @param {HTMLElement} tile - цЦ╣хЭЧхЕГч┤а
       * @param {number} value - цЦ╣хЭЧцХ░хА╝
       */
      adjustTileFontSize(tile, value) {
        const textLength = String(value).length;
        let fontSize = '1.5rem';
        if (textLength === 4) {
          fontSize = '1.2rem';
        } else if (textLength >= 5) {
          fontSize = '1rem';
        }
        tile.style.fontSize = fontSize;
      }
      /**
       * цЫ┤цЦ░хИЖцХ░цШ╛чд║
       * @param {boolean} [showAnimation=true] - цШпхРжцШ╛чд║хИЖцХ░хПШхМЦхКичФ╗
       */
      updateScoreDisplay(showAnimation = true) {
        this.dom.scoreDisplay.textContent = this.score;
        // цЫ┤цЦ░цЬАщлШхИЖ
        if (this.score > this.bestScore) {
          this.bestScore = this.score;
          localStorage.setItem('2048-best-score', this.bestScore);
        }
        this.dom.bestScoreDisplay.textContent = this.bestScore;
        if (showAnimation && !gameSettings.disableAnimations) {
          this.dom.scoreDisplay.classList.add('score-change');
          setTimeout(() => {
            this.dom.scoreDisplay.classList.remove('score-change');
          }, 300);
        }
      }
      /**
       * цгАцЯец╕╕цИПцШпхРжхПпф╗ечз╗хКи
       * @returns {boolean} цШпхРжхПпф╗ечз╗хКи
       */
      canMove() {
        // цгАцЯецШпхРжцЬЙчй║ф╜Нч╜о
        for (let y = 0; y < config.gridSize; y++) {
          for (let x = 0; x < config.gridSize; x++) {
            if (this.grid[y][x] === null) {
              return true;
            }
          }
        }
        // цгАцЯечЫ╕щВ╗цЦ╣хЭЧцШпхРжхПпф╗ехРИх╣╢
        for (let y = 0; y < config.gridSize; y++) {
          for (let x = 0; x < config.gridSize; x++) {
            const value = this.grid[y][x];
            if (x < config.gridSize - 1 && this.grid[y][x + 1] === value) {
              return true;
            }
            if (y < config.gridSize - 1 && this.grid[y + 1][x] === value) {
              return true;
            }
          }
        }
        return false;
      }
      /**
       * хдДчРЖцЦ╣хЭЧчз╗хКи
       * @param {string} direction - чз╗хКицЦ╣хРС ('up', 'down', 'left', 'right')
       * @returns {Promise<boolean>} цШпхРжцИРхКЯчз╗хКи
       */
      async move(direction) {
        if (this.isProcessingMove) return false;
        this.isProcessingMove = true;
        this.isAnimating = true;
        let moved = false;
        let scoreChanged = false;
        const movePromises = [];
        switch (direction) {
          case 'up':
            for (let x = 0; x < config.gridSize; x++) {
              for (let y = 1; y < config.gridSize; y++) {
                if (this.grid[y][x]) {
                  const moveResult = this.processMove(x, y, 0, -1, movePromises);
                  moved = moveResult.moved || moved;
                  scoreChanged = moveResult.scoreChanged || scoreChanged;
                }
              }
            }
            break;
          case 'down':
            for (let x = 0; x < config.gridSize; x++) {
              for (let y = config.gridSize - 2; y >= 0; y--) {
                if (this.grid[y][x]) {
                  const moveResult = this.processMove(x, y, 0, 1, movePromises);
                  moved = moveResult.moved || moved;
                  scoreChanged = moveResult.scoreChanged || scoreChanged;
                }
              }
            }
            break;
          case 'left':
            for (let y = 0; y < config.gridSize; y++) {
              for (let x = 1; x < config.gridSize; x++) {
                if (this.grid[y][x]) {
                  const moveResult = this.processMove(x, y, -1, 0, movePromises);
                  moved = moveResult.moved || moved;
                  scoreChanged = moveResult.scoreChanged || scoreChanged;
                }
              }
            }
            break;
          case 'right':
            for (let y = 0; y < config.gridSize; y++) {
              for (let x = config.gridSize - 2; x >= 0; x--) {
                if (this.grid[y][x]) {
                  const moveResult = this.processMove(x, y, 1, 0, movePromises);
                  moved = moveResult.moved || moved;
                  scoreChanged = moveResult.scoreChanged || scoreChanged;
                }
              }
            }
            break;
        }
        if (moved) {
          // цЫ┤цЦ░хИЖцХ░
          this.updateScoreDisplay(scoreChanged);
          // чнЙх╛ЕцЙАцЬЙхКичФ╗хоМцИР
          if (!gameSettings.disableAnimations && movePromises.length > 0) {
            await Promise.all(movePromises);
            await new Promise(resolve => requestAnimationFrame(resolve));
          }
          // ц╖╗хКацЦ░цЦ╣хЭЧ
          this.addRandomTile();
          // цгАцЯец╕╕цИПцШпхРжч╗УцЭЯ
          if (!this.canMove()) {
            setTimeout(() => {
              utils.showGameStatus('gameOver');
            }, 300);
          }
        }
        // цгАцЯец╕╕цИПчК╢цАБ
        setTimeout(() => {
          this.isAnimating = false;
          this.isProcessingMove = false;
        }, gameSettings.disableAnimations ? 0 : 300);
        return moved;
      }
      /**
       * хдДчРЖхНХф╕кцЦ╣хЭЧчЪДчз╗хКищА╗ш╛С
       * @param {number} x - ш╡╖хзЛxхЭРцаЗ
       * @param {number} y - ш╡╖хзЛyхЭРцаЗ
       * @param {number} dx - xцЦ╣хРСхвЮщЗП
       * @param {number} dy - yцЦ╣хРСхвЮщЗП
       * @param {Array<Promise>} movePromises - хКичФ╗PromiseцХ░ч╗Д
       * @returns {object} чз╗хКич╗УцЮЬ { moved: boolean, scoreChanged: boolean }
       */
      processMove(x, y, dx, dy, movePromises) {
        let newX = x, newY = y;
        const value = this.grid[y][x];
        let moved = false;
        let scoreChanged = false;
        // хп╗цЙ╛хПпф╗ечз╗хКихИ░чЪДцЬАч╗Иф╜Нч╜о
        while (
          newX + dx >= 0 && newX + dx < config.gridSize &&
          newY + dy >= 0 && newY + dy < config.gridSize &&
          !this.grid[newY + dy][newX + dx]
        ) {
          newX += dx;
          newY += dy;
          moved = true;
        }
        // цгАцЯецШпхРжхПпф╗ехРИх╣╢
        if (
          newX + dx >= 0 && newX + dx < config.gridSize &&
          newY + dy >= 0 && newY + dy < config.gridSize &&
          this.grid[newY + dy][newX + dx] === value
        ) {
          const targetX = newX + dx;
          const targetY = newY + dy;
          this.grid[targetY][targetX] *= 2;
          this.score += this.grid[targetY][targetX];
          this.grid[y][x] = null;
          // хдДчРЖхРИх╣╢хКичФ╗
          if (!gameSettings.disableAnimations) {
            movePromises.push(this.animateTileMerge(x, y, targetX, targetY, this.grid[targetY][targetX]));
          } else {
            const originalTile = document.querySelector(`.tile[data-x="${x}"][data-y="${y}"]`);
            if (originalTile) originalTile.remove();
            this.renderTile(targetX, targetY, this.grid[targetY][targetX], false, false);
          }
          moved = true;
          scoreChanged = true;
          // ЁЯФз ф┐охдНя╝ЪшГЬхИйцЭбф╗╢цФ╣ф╕║ >=
          if (this.grid[targetY][targetX] >= config.winningValue && !this.gameWon) {
            this.gameWon = true;
            setTimeout(() => utils.showGameStatus('won'), 500);
          }
        } 
        // хдДчРЖхНХч║пчз╗хКи
        else if (newX !== x || newY !== y) {
          if (!gameSettings.disableAnimations) {
            movePromises.push(this.animateTileMove(x, y, newX, newY));
          } else {
            const originalTile = document.querySelector(`.tile[data-x="${x}"][data-y="${y}"]`);
            if (originalTile) originalTile.remove();
            this.renderTile(newX, newY, value, false, false);
          }
          this.grid[newY][newX] = value;
          this.grid[y][x] = null;
          moved = true;
        }
        return { moved, scoreChanged };
      }
      /**
       * хКичФ╗я╝ЪцЦ╣хЭЧчз╗хКи
       * @param {number} fromX - ш╡╖хзЛxхЭРцаЗ
       * @param {number} fromY - ш╡╖хзЛyхЭРцаЗ
       * @param {number} toX - чЫоцаЗxхЭРцаЗ
       * @param {number} toY - чЫоцаЗyхЭРцаЗ
       * @returns {Promise} хКичФ╗хоМцИРPromise
       */
      animateTileMove(fromX, fromY, toX, toY) {
        return new Promise(resolve => {
          const tile = document.querySelector(`.tile[data-x="${fromX}"][data-y="${fromY}"]`);
          if (tile) {
            // шобчоЧчЫоцаЗф╜Нч╜о
            const targetX = this.boardPadding + toX * (this.tileSize + this.tileGap);
            const targetY = this.boardPadding + toY * (this.tileSize + this.tileGap);
            // х║ФчФиш┐Зц╕бхКичФ╗
            tile.style.transition = 'left 0.2s ease, top 0.2s ease';
            tile.style.left = `${targetX}px`;
            tile.style.top = `${targetY}px`;
            // цЫ┤цЦ░цХ░цНох▒ЮцАз
            tile.dataset.x = toX;
            tile.dataset.y = toY;
            // хКичФ╗ч╗УцЭЯхРОц╕ЕчРЖ
            setTimeout(() => {
              tile.style.transition = '';
              resolve();
            }, 200);
          } else {
            resolve();
          }
        });
      }
      /**
       * хКичФ╗я╝ЪцЦ╣хЭЧхРИх╣╢
       * @param {number} fromX - ш╡╖хзЛxхЭРцаЗ
       * @param {number} fromY - ш╡╖хзЛyхЭРцаЗ
       * @param {number} toX - чЫоцаЗxхЭРцаЗ
       * @param {number} toY - чЫоцаЗyхЭРцаЗ
       * @param {number} value - хРИх╣╢хРОчЪДхА╝
       * @returns {Promise} хКичФ╗хоМцИРPromise
       */
      animateTileMerge(fromX, fromY, toX, toY, value) {
        return new Promise(resolve => {
          const tile = document.querySelector(`.tile[data-x="${fromX}"][data-y="${fromY}"]`);
          if (tile) {
            // шобчоЧчЫоцаЗф╜Нч╜о
            const targetX = this.boardPadding + toX * (this.tileSize + this.tileGap);
            const targetY = this.boardPadding + toY * (this.tileSize + this.tileGap);
            // х║ФчФиш┐Зц╕бхКичФ╗
            tile.style.transition = 'left 0.2s ease, top 0.2s ease';
            tile.style.left = `${targetX}px`;
            tile.style.top = `${targetY}px`;
            // хКичФ╗ч╗УцЭЯхРОц╕▓цЯУхРИх╣╢хРОчЪДцЦ╣хЭЧ
            setTimeout(() => {
              tile.remove();
              this.renderTile(toX, toY, value, false, true);
              resolve();
            }, 200);
          } else {
            resolve();
          }
        });
      }
      /**
       * чкЧхПгхдзх░ПхПШхМЦцЧ╢щЗНцЦ░ш░ГцХ┤
       */
      handleResize() {
        if (this.isAnimating) return;
        this.calculateTileSize();
        this.renderGrid();
        for (let y = 0; y < config.gridSize; y++) {
          for (let x = 0; x < config.gridSize; x++) {
            if (this.grid[y][x]) {
              this.renderTile(x, y, this.grid[y][x]);
            }
          }
        }
      }
      /**
       * шГЬхИйхРОч╗зч╗нц╕╕цИП
       */
      resumeAfterWin() {
        this.gameWon = false;
      }
    }
    // --- ф║Лф╗╢хдДчРЖхТМхИЭхзЛхМЦ ---
    document.addEventListener('DOMContentLoaded', () => {
      // хИЭхзЛхМЦшпншиА
      utils.updateUI();
      utils.getElements('.language-option').forEach(option => {
        option.classList.toggle('active', option.dataset.lang === currentLanguage);
      });
      // хИЭхзЛхМЦц╕╕цИПхоЮф╛Лх╣╢ф┐ЭхнШхИ░хЕих▒АхПШщЗП
      const game = new Game2048();
      window.game = game; // ф┐ЭхнШхИ░хЕих▒АхПШщЗП
      // --- шпншиАхИЗцНвф║Лф╗╢ ---
      utils.getElements('.language-option').forEach(option => {
        option.addEventListener('click', () => {
          currentLanguage = option.dataset.lang;
          localStorage.setItem('2048-language', currentLanguage);
          utils.getElements('.language-option').forEach(opt => opt.classList.remove('active'));
          option.classList.add('active');
          utils.updateUI();
        });
      });
      // --- ф╕╗щвШхИЗцНвхКЯшГ╜ ---
      game.dom.themeToggle = utils.getElement('#themeToggle');
      const savedTheme = localStorage.getItem('2048-theme') || 'light';
      document.documentElement.classList.toggle('dark', savedTheme === 'dark');
      game.dom.themeToggle.checked = savedTheme === 'dark';
      game.dom.themeToggle.addEventListener('change', function() {
        document.documentElement.classList.toggle('dark', this.checked);
        localStorage.setItem('2048-theme', this.checked ? 'dark' : 'light');
      });
      // --- хКичФ╗шо╛ч╜охКЯшГ╜ ---
      game.dom.disableAnimationsToggle = utils.getElement('#disableAnimationsToggle');
      game.dom.disableAnimationsToggle.checked = gameSettings.disableAnimations;
      game.dom.disableAnimationsToggle.addEventListener('change', function() {
        gameSettings.disableAnimations = this.checked;
        localStorage.setItem('2048-disable-animations', gameSettings.disableAnimations);
      });
      // --- ц╕╕цИПщЪ╛х║жшо╛ч╜охКЯшГ╜ ---
      game.dom.difficultySlider = utils.getElement('#difficultySlider');
      game.dom.difficultyValue = utils.getElement('#difficultyValue');
      game.dom.difficultySlider.value = gameSettings.difficulty;
      function updateDifficultyDisplay() {
        const difficulty = parseInt(game.dom.difficultySlider.value);
        let difficultyKey = '';
        switch(difficulty) {
          case 1: difficultyKey = 'difficultyEasy'; break;
          case 2: difficultyKey = 'difficultyMedium'; break;
          case 3: difficultyKey = 'difficultyHard'; break;
        }
        game.dom.difficultyValue.textContent = translations[currentLanguage][difficultyKey];
      }
      updateDifficultyDisplay();
      game.dom.difficultySlider.addEventListener('input', updateDifficultyDisplay);
      game.dom.difficultySlider.addEventListener('change', function() {
        gameSettings.difficulty = parseInt(this.value);
        localStorage.setItem('2048-difficulty', gameSettings.difficulty);
        // щЗНч╜оц╕╕цИПф╗ех║ФчФицЦ░щЪ╛х║ж
        game.init();
      });
      // --- щФочЫШш╛УхЕехдДчРЖ ---
      function handleKeydown(e) {
        // щШ╗цнвцЦ╣хРСщФохТМWASDщФочЪДщ╗Шшодц╗ЪхКишбМф╕║
        if ([37, 38, 39, 40, 87, 65, 83, 68].includes(e.keyCode)) {
          e.preventDefault();
        }
        switch (e.keyCode) {
          case 38: case 87: game.move('up'); break;
          case 40: case 83: game.move('down'); break;
          case 37: case 65: game.move('left'); break;
          case 39: case 68: game.move('right'); break;
        }
      }
      // --- шзжцС╕ш╛УхЕехдДчРЖ ---
      let touchStartX = 0;
      let touchStartY = 0;
      let touchStartTime = 0;
      let touchTimeout = null;
      function handleTouchStart(e) {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
        touchStartTime = Date.now();
        if (touchTimeout) clearTimeout(touchTimeout);
      }
      function handleTouchMove(e) {
        e.preventDefault();
      }
      function handleTouchEnd(e) {
        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        const dx = touchEndX - touchStartX;
        const dy = touchEndY - touchStartY;
        const duration = Date.now() - touchStartTime;
        const threshold = Math.max(20, Math.min(50, game.dom.gameContainer.clientWidth * 0.1));
        // хИдцЦнц╗СхКицЦ╣хРС
        if (Math.abs(dx) > Math.abs(dy)) {
          if (dx > threshold) {
            game.move('right');
          } else if (dx < -threshold) {
            game.move('left');
          }
        } else {
          if (dy > threshold) {
            game.move('down');
          } else if (dy < -threshold) {
            game.move('up');
          }
        }
        // щШ▓цнвчЯнцЧ╢щЧ┤хЖЕхдЪцмбшзжхПС
        touchTimeout = setTimeout(() => {
          touchTimeout = null;
        }, gameSettings.disableAnimations ? 0 : 200);
      }
      // --- ф║Лф╗╢ч╗СхоЪ ---
      window.addEventListener('resize', () => game.handleResize());
      document.addEventListener('keydown', handleKeydown);
      // шзжцС╕ф║Лф╗╢
      game.dom.gameContainer.addEventListener('touchstart', handleTouchStart);
      game.dom.gameContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
      game.dom.gameContainer.addEventListener('touchend', handleTouchEnd);
      // ц╕╕цИПцОзхИ╢цМЙщТо
      game.dom.restartBtn.addEventListener('click', () => game.init());
      // цибцАБцбЖцОзхИ╢
      game.dom.howToPlayBtn.addEventListener('click', () => utils.openModal('howToPlayModal'));
      game.dom.closeHowToPlayModalBtn.addEventListener('click', () => utils.closeModal('howToPlayModal'));
      game.dom.startPlayingBtn.addEventListener('click', () => utils.closeModal('howToPlayModal'));
      game.dom.howToPlayModal.addEventListener('click', (e) => {
        if (e.target === game.dom.howToPlayModal) {
          utils.closeModal('howToPlayModal');
        }
      });
      game.dom.settingsBtn.addEventListener('click', () => utils.openModal('settingsModal'));
      game.dom.closeSettingsModalBtn.addEventListener('click', () => utils.closeModal('settingsModal'));
      game.dom.closeSettingsBtn.addEventListener('click', () => utils.closeModal('settingsModal'));
      game.dom.settingsModal.addEventListener('click', (e) => {
        if (e.target === game.dom.settingsModal) {
          utils.closeModal('settingsModal');
        }
      });
    });
  </script>
</body>
</html>